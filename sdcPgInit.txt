-- CREATE DATABASE lybica
--     [ WITH ] [ OWNER [=] user_name ]
--            [ TEMPLATE [=] template ]
--            [ ENCODING [=] encoding ]
--            [ STRATEGY [=] strategy ] ]
--            [ LOCALE [=] locale ]
--            [ LC_COLLATE [=] lc_collate ]
--            [ LC_CTYPE [=] lc_ctype ]
--            [ ICU_LOCALE [=] icu_locale ]
--            [ LOCALE_PROVIDER [=] locale_provider ]
--            [ COLLATION_VERSION = collation_version ]
--            [ TABLESPACE [=] tablespace_name ]
--            [ ALLOW_CONNECTIONS [=] allowconn ]
--            [ CONNECTION LIMIT [=] connlimit ]
--            [ IS_TEMPLATE [=] istemplate ]
--            [ OID [=] oid ]


-- ALTER TABLE "products" DROP CONSTRAINT IF EXISTS "products_fk0";
-- ALTER TABLE "styles" DROP CONSTRAINT IF EXISTS "styles_fk0";
-- DROP TABLE IF EXISTS "public.products"

DROP TABLE IF EXISTS "public.products", "public.styles";
DROP TABLE IF EXISTS products, styles;

CREATE TABLE products (
	"id" serial NOT NULL UNIQUE,
	"name" TEXT NOT NULL UNIQUE,
	"slogan" TEXT,
	"description" TEXT,
	"category" TEXT,
	"default_price" DECIMAL(12,2) NOT NULL,
	"features" jsonb,
	"related_products" integer[]
);



CREATE TABLE styles (
	"id" serial NOT NULL,
	"name" TEXT NOT NULL UNIQUE,
	"original_price" DECIMAL(12,2) NOT NULL,
	"sale_price" DECIMAL(12,2) NOT NULL,
	"default?" bool NOT NULL,
	"photos" jsonb,
	"skus" jsonb,
	"product_id" integer NOT NULL,
	CONSTRAINT "styles_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);

ALTER TABLE styles ADD CONSTRAINT "styles_fk0" FOREIGN KEY ("product_id") REFERENCES "products"("id");
